(function(a){a.fn.fbphotoselector=function(b){var c=a.extend({},a.fn.fbphotoselector.defaults,b);return this.each(function(){function f(a,b){var d="";d=d+"<li>";d=d+"<a href='javascript:void(0);' data-id='"+a.id+"' data-image='https://graph.facebook.com/"+a.id+"/picture?type=normal&access_token="+b+"' data-thumbnail='https://graph.facebook.com/"+a.id+"/picture?type=thumbnail&access_token="+b+"' class='photoLink'>";d=d+"<img src='https://graph.facebook.com/"+a.id+"/picture?type="+c.sizePhoto+"&access_token="+b+"'>";d=d+"</a>";d=d+"</li>";return d}function e(a,b){var d="";d=d+"<li>";d=d+"<a href='javascript:void(0);' data-id='"+a.id+"' class='albumLink'>";d=d+"<img src='https://graph.facebook.com/"+a.cover_photo+"/picture?type="+c.sizeAlbum+"&access_token="+b+"'>";d=d+"<p>"+a.name+"</p>";d=d+"</a>";d=d+"</li>";return d}function d(g){b.html(c.loadingText);FB.api("/me/albums?limit=0",function(h){var i="<ul class='fbAlbums'>";var j=h.data;var k=j.length;if(c.albumsByPage>0&&c.albumsByPage<j.length){var l=Math.ceil(j.length/c.albumsByPage);k=c.albumsByPage}for(var m=0,n=k;m<n;m++){var o=j[m];i=i+e(o,g)}i=i+"</ul>";var p="";if(c.breadcrumb===true){p="<nav class='breadcrumb'>Albums</nav>"}p=p+i;if(c.albumsByPage>0&&c.albumsByPage<j.length){var q="<nav class='pagination'><ul>";for(var m=0,n=l;m<n;m++){numPage=m+1;q=q+"<li><a ";if(numPage==1){q=q+"class='current'"}q=q+" href='javascript:void(0);'>"+numPage+"</a></li>"}q=q+"</ul></nav>";p=p+q}b.html(p);a(".pagination ul li a").click(function(){a(".pagination ul li a").removeClass("current");a(this).addClass("current");var d=a(this).html();var f=c.albumsByPage*(d-1);var h="";for(var i=f,k=f+c.albumsByPage;i<k;i++){var l=j[i];if(l!==undefined){h=h+e(l,g)}}a("ul.fbAlbums",b).html(h);a(".albumLink",b).click(function(){r(a(this))})});var r=function(e){var h=a("p",e).html();b.html(c.loadingText);FB.api("/"+e.data("id")+"/photos?limit=0",function(e){var i="<ul class='fbPhotos'>";var j=e.data;var k=j.length;if(c.photosByPage>0&&c.photosByPage<j.length){var l=Math.ceil(j.length/c.photosByPage);k=c.photosByPage}for(var m=0,n=k;m<n;m++){var o=j[m];i=i+f(o,g)}i=i+"</ul>";var p="";if(c.breadcrumb===true){p="<nav class='breadcrumb'><a class='albumBack' href='javascript:void(0);'>Albums</a> > "+h+"</nav>"}var q="<a class='btn btnBack' href='javascript:void(0);'>"+c.backText+"</a>";if(c.backButtonOnTop===true){p=p+q}p=p+i;if(c.photosByPage>0&&c.photosByPage<j.length){var r="<nav class='pagination'><ul>";for(var m=0,n=l;m<n;m++){numPage=m+1;r=r+"<li><a ";if(numPage==1){r=r+"class='current'"}r=r+" href='javascript:void(0);'>"+numPage+"</a></li>"}r=r+"</ul></nav>";p=p+r}if(c.backButtonOnBottom===true){p=p+q}b.html(p);a(".pagination ul li a").click(function(){a(".pagination ul li a").removeClass("current");a(this).addClass("current");var d=a(this).html();var e=c.photosByPage*(d-1);var h="";for(var i=e,k=e+c.photosByPage;i<k;i++){var l=j[i];if(l!==undefined){h=h+f(l,g)}}a("ul.fbPhotos",b).html(h);a(".photoLink",b).click(function(){s(a(this))})});a(".albumBack,.btnBack",b).click(function(){d(g)});var s=function(a){var b={id:a.data("id"),image:a.data("image"),thumbnail:a.data("thumbnail")};c.onSelect(b)};a(".photoLink",b).click(function(){s(a(this))})})};a(".albumLink",b).click(function(){r(a(this))})})}var b=a(this);FB.getLoginStatus(function(c){if(c.status==="connected"){d(c.authResponse.accessToken)}else{b.html("<a class='facebookLogin' href=''>Login with facebook</a>");a(".facebookLogin").click(function(){FB.login(function(a){if(a.authResponse){d(a.authResponse.accessToken)}},{scope:"user_photos"});return false})}})})};a.fn.fbphotoselector.defaults={breadcrumb:true,backButtonOnTop:false,backButtonOnBottom:true,sizeAlbum:"thumbnail",sizePhoto:"thumbnail",loadingText:"Loading...",backText:"Back",albumsByPage:0,photosByPage:0,onSelect:function(a){var b="Id: "+a.id+"\n\nLink image: "+a.image+"\n\nLink thumbnail: "+a.thumbnail;console.log(b)}}})(jQuery)